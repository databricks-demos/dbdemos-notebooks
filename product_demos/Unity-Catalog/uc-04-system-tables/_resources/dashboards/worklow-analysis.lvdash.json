{
  "datasets": [
    {
      "name": "c9815047",
      "displayName": "summary_master_dataset",
      "query": "-- CTE to fetch the latest job metadata per workspace and job\nWITH latest_job_metadata AS (\n  SELECT\n    *,\n    ROW_NUMBER() OVER (\n      PARTITION BY workspace_id, job_id \n      ORDER BY change_time DESC\n    ) AS rn\n  FROM\n    system.lakeflow.jobs\n  QUALIFY rn = 1\n),\n\n-- CTE to fetch the latest cluster metadata per workspace and cluster\nlatest_clusters_metadata AS (\n  SELECT\n    *,\n    ROW_NUMBER() OVER (\n      PARTITION BY workspace_id, cluster_id \n      ORDER BY change_time DESC\n    ) AS rn\n  FROM\n    system.compute.clusters\n  QUALIFY rn = 1\n),\n\n-- CTE for job run timeline details, including calculated duration and success/failure flags\njrt AS (\n  SELECT\n    jr.account_id,\n    jr.workspace_id,\n    jr.job_id,\n    j.name AS job_name,\n    j.creator_id,\n    j.run_as,\n    jr.run_id,\n    jr.period_start_time,\n    jr.period_end_time,\n    jr.trigger_type,\n    jr.run_type,\n    COALESCE(jr.result_state, 0) AS result_state,\n    jr.compute_ids,\n    (UNIX_TIMESTAMP(jr.period_end_time) - UNIX_TIMESTAMP(jr.period_start_time)) / 60 AS duration_minutes,\n    CASE WHEN jr.result_state = 'SUCCEEDED' THEN jr.run_id ELSE NULL END AS success_run_ids,\n    CASE WHEN jr.result_state <> 'SUCCEEDED' THEN jr.run_id ELSE NULL END AS failure_run_ids\n  FROM\n    system.lakeflow.job_run_timeline jr\n  JOIN latest_job_metadata j ON jr.job_id = j.job_id\n  WHERE\n    jr.period_start_time BETWEEN :start_date AND :end_date\n),\n\n-- CTE for pricing information\npricing AS (\n  SELECT\n    p.pricing.effective_list.default AS price_per_unit,\n    p.price_start_time,\n    p.sku_name,\n    COALESCE(p.price_end_time, NOW()) AS price_end_time\n  FROM\n    system.billing.list_prices p\n),\n\n-- CTE for usage data with user name extraction, job details, and dollar calculation\nusage_with_names AS (\n  SELECT\n    jrt.account_id,\n    jrt.workspace_id,\n    jrt.job_id,\n    u.usage_date,\n    u.usage_quantity,\n    u.sku_name,\n    TRANSFORM(\n      MAP_KEYS(custom_tags), (k, i) -> CONCAT(\n        lower(k),\n        '=',\n        lower(MAP_VALUES(custom_tags)[i])\n      )\n    ) AS key_value_tags,\n    u.usage_metadata,\n    jrt.job_name,\n    CASE \n      WHEN REGEXP_REPLACE(\n        u.identity_metadata.run_as,\n        '([a-zA-Z]+)\\\\.([a-zA-Z]+)@.*',\n        '$1 $2'\n      ) = u.identity_metadata.run_as THEN u.identity_metadata.run_as\n      ELSE INITCAP(\n        REGEXP_REPLACE(\n          u.identity_metadata.run_as,\n          '([a-zA-Z]+)\\\\.([a-zA-Z]+)@.*',\n          '$1 $2'\n        )\n      )\n    END AS user_name_cleaned,\n    jrt.run_id,\n    jrt.success_run_ids,\n    jrt.failure_run_ids,\n    jrt.duration_minutes,\n    jrt.result_state,\n    jrt.trigger_type,\n    p.price_per_unit,\n    u.usage_quantity * p.price_per_unit AS dollar_cost  -- Calculate cost in dollars\n  FROM\n    system.billing.usage u\n  JOIN jrt ON u.usage_metadata['job_run_id'] = jrt.run_id\n    AND u.usage_metadata['job_id'] = jrt.job_id\n  INNER JOIN pricing p ON u.sku_name = p.sku_name\n    AND u.usage_start_time BETWEEN p.price_start_time AND p.price_end_time  -- Match correct pricing interval\n  WHERE\n    u.usage_date BETWEEN :start_date AND :end_date\n    AND (\n      :tags = 'All'\n      OR array_contains(\n        TRANSFORM(\n          MAP_KEYS(custom_tags), (k, i) -> CONCAT(\n            lower(k),\n            '=',\n            lower(MAP_VALUES(custom_tags)[i])\n          )\n        ),\n        :tags\n      )\n    )\n),\n\n-- CTE to get top 10 jobs by usage quantity\ntop_jobs AS (\n  SELECT\n    job_name,\n    SUM(usage_quantity) AS total_usage\n  FROM\n    usage_with_names\n  GROUP BY\n    job_name\n  ORDER BY\n    total_usage DESC\n  LIMIT :top_k\n),\n\n-- CTE to get top 10 users by usage quantity\ntop_users AS (\n  SELECT\n    user_name_cleaned AS user,\n    SUM(usage_quantity) AS total_usage\n  FROM\n    usage_with_names\n  GROUP BY\n    user_name_cleaned\n  ORDER BY\n    total_usage DESC\n  LIMIT :top_k\n)\n\n-- Final query with grouping for top jobs and users\nSELECT\n  uwn.account_id,\n  uwn.workspace_id,\n  uwn.usage_date,\n  uwn.usage_quantity,\n  uwn.sku_name,\n  key_value_tags,\n  uwn.job_id,\n  uwn.job_name,\n  uwn.run_id,\n  uwn.success_run_ids,\n  uwn.failure_run_ids,\n  uwn.result_state,\n  uwn.user_name_cleaned AS user,\n  CASE\n    WHEN uwn.job_name IN (SELECT job_name FROM top_jobs) THEN uwn.job_name\n    ELSE 'All Others'\n  END AS job_name_group,\n  CASE\n    WHEN uwn.user_name_cleaned IN (SELECT user FROM top_users) THEN uwn.user_name_cleaned\n    ELSE 'All Others'\n  END AS user_group,\n  uwn.duration_minutes,\n  uwn.trigger_type,\n  uwn.price_per_unit,\n  uwn.dollar_cost  -- Include dollar cost in the final output\nFROM\n  usage_with_names uwn",
      "parameters": [
        {
          "displayName": "start_date",
          "keyword": "start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "now-30d/d"
                }
              ]
            }
          }
        },
        {
          "displayName": "end_date",
          "keyword": "end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "now/d"
                }
              ]
            }
          }
        },
        {
          "displayName": "tags",
          "keyword": "tags",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "All"
                }
              ]
            }
          }
        },
        {
          "displayName": "top_k",
          "keyword": "top_k",
          "dataType": "INTEGER",
          "defaultSelection": {
            "values": {
              "dataType": "INTEGER",
              "values": [
                {
                  "value": "10"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "a11eb5cf",
      "displayName": "job_metadata",
      "query": "-- CTE to fetch the latest job metadata per workspace and job\nWITH latest_job_metadata AS (\n  SELECT\n    *,\n    ROW_NUMBER() OVER (\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) AS rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n),\n-- CTE to fetch the latest cluster metadata per workspace and cluster\nlatest_clusters_metadata AS (\n  SELECT\n    *,\n    ROW_NUMBER() OVER (\n      PARTITION BY workspace_id,\n      cluster_id\n      ORDER BY\n        change_time DESC\n    ) AS rn\n  FROM\n    system.compute.clusters -- WHERE\n    --   cluster_source IN ('UI', 'API')\n    QUALIFY rn = 1\n),\n-- CTE for job run timeline details, including calculated duration and success/failure flags\njrt AS (\n  SELECT\n    jr.account_id,\n    jr.workspace_id,\n    jr.job_id,\n    j.name AS job_name,\n    j.creator_id,\n    j.run_as,\n    jr.run_id,\n    jr.period_start_time,\n    jr.period_end_time,\n    jr.trigger_type,\n    jr.run_type,\n    nvl(jr.result_state, 0) as result_state,\n    jr.compute_ids,\n    (\n      UNIX_TIMESTAMP(jr.period_end_time) - UNIX_TIMESTAMP(jr.period_start_time)\n    ) / 60 AS duration_minutes,\n    CASE\n      WHEN jr.result_state = 'SUCCEEDED' THEN jr.run_id\n      ELSE NULL\n    END AS success_run_ids,\n    CASE\n      WHEN jr.result_state <> 'SUCCEEDED' THEN jr.run_id\n      ELSE NULL\n    END AS failure_run_ids\n  FROM\n    system.lakeflow.job_run_timeline jr\n    JOIN latest_job_metadata j ON jr.job_id = j.job_id\n  WHERE\n    jr.period_start_time between :start_date\n    AND :end_date\n),\n-- CTE for usage data with user name extraction and job details\nusage_with_names AS (\n  SELECT\n    jrt.account_id,\n    jrt.workspace_id,\n    jrt.job_id,\n    u.usage_date,\n    u.usage_quantity,\n    u.sku_name,\n    TRANSFORM(\n      MAP_KEYS(custom_tags),(k, i) -> CONCAT(\n        lower(k),\n        '=',\n        lower(MAP_VALUES(custom_tags) [i])\n      )\n    ) AS key_value_tags,\n    u.usage_metadata,\n    jrt.job_name,\n    -- Extracts user name from email, defaults to full email if regex does not match\n    CASE\n      WHEN REGEXP_REPLACE(\n        u.identity_metadata.run_as,\n        '([a-zA-Z]+)\\\\.([a-zA-Z]+)@.*',\n        '$1 $2'\n      ) = u.identity_metadata.run_as THEN u.identity_metadata.run_as\n      ELSE initcap(\n        REGEXP_REPLACE(\n          u.identity_metadata.run_as,\n          '([a-zA-Z]+)\\\\.([a-zA-Z]+)@.*',\n          '$1 $2'\n        )\n      )\n    END AS user_name_cleaned,\n    jrt.run_id,\n    jrt.success_run_ids,\n    jrt.failure_run_ids,\n    jrt.duration_minutes,\n    jrt.result_state,\n    jrt.trigger_type\n  FROM\n    system.billing.usage u\n    JOIN jrt ON u.usage_metadata ['job_run_id'] = jrt.run_id\n    AND u.usage_metadata ['job_id'] = jrt.job_id\n  WHERE\n    u.usage_date between :start_date\n    AND :end_date\n    and (\n      :tags = 'All'\n      or array_contains(\n        TRANSFORM(\n          MAP_KEYS(custom_tags),(k, i) -> CONCAT(\n            lower(k),\n            '=',\n            lower(MAP_VALUES(custom_tags) [i])\n          )\n        ),\n        :tags\n      )\n    )\n),\n-- CTE to get top 10 jobs by usage quantity\ntop_jobs AS (\n  SELECT\n    job_name,\n    SUM(usage_quantity) AS total_usage\n  FROM\n    usage_with_names\n  GROUP BY\n    job_name\n  ORDER BY\n    total_usage DESC\n  -- LIMIT\n  --   :top_k\n)\n-- Final query with grouping for top jobs and users\nSELECT\n  uwn.account_id,\n  uwn.workspace_id,\n  uwn.usage_date,\n  uwn.sku_name,\n  -- key_value_tags,\n  uwn.job_id,\n  uwn.job_name,\n  -- uwn.run_id,\n  -- uwn.success_run_ids,\n  -- uwn.failure_run_ids,\n  uwn.result_state,\n  count(distinct run_id) as runs,\n  count(distinct success_run_ids) as success_runs,\n  count(distinct failure_run_ids) as unsuccssful_runs,\n  uwn.user_name_cleaned AS user,\n  uwn.trigger_type,\n  avg(uwn.duration_minutes) as avg_duration_minutes,\n  sum(uwn.usage_quantity) as usage_quantity\nFROM\n  usage_with_names uwn\n  join top_jobs tj ON uwn.job_name = tj.job_name\nGROUP BY ALL",
      "parameters": [
        {
          "displayName": "start_date",
          "keyword": "start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "now-30d/d"
                }
              ]
            }
          }
        },
        {
          "displayName": "end_date",
          "keyword": "end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "now/d"
                }
              ]
            }
          }
        },
        {
          "displayName": "tags",
          "keyword": "tags",
          "dataType": "STRING",
          "defaultSelection": {
            "values": {
              "dataType": "STRING",
              "values": [
                {
                  "value": "All"
                }
              ]
            }
          }
        }
      ]
    },
    {
      "name": "e61b017f",
      "displayName": "job_task_timeline",
      "query": "-- CTE to fetch the latest job metadata per workspace and job\nWITH latest_job_metadata AS (\n  SELECT\n    job_id,\n    name,\n    run_as,\n    creator_id,\n    description,\n    ROW_NUMBER() OVER (\n      PARTITION BY workspace_id,\n      job_id\n      ORDER BY\n        change_time DESC\n    ) AS rn\n  FROM\n    system.lakeflow.jobs QUALIFY rn = 1\n)\nselect\n  *,\n  (\n    UNIX_TIMESTAMP(jtrt.period_end_time) - UNIX_TIMESTAMP(jtrt.period_start_time)\n  ) / 60 AS task_duration_minutes\nfrom\n  system.lakeflow.job_task_run_timeline jtrt\n  join latest_job_metadata j USING (job_id)\nwhere\n  period_start_time BETWEEN :start_date\n  and :end_date",
      "parameters": [
        {
          "displayName": "start_date",
          "keyword": "start_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "now-30d/d"
                }
              ]
            }
          }
        },
        {
          "displayName": "end_date",
          "keyword": "end_date",
          "dataType": "DATE",
          "defaultSelection": {
            "values": {
              "dataType": "DATE",
              "values": [
                {
                  "value": "now/d"
                }
              ]
            }
          }
        }
      ]
    }
  ],
  "pages": [
    {
      "name": "e09fd648",
      "displayName": "Jobs Summary",
      "layout": [
        {
          "widget": {
            "name": "a4077e8f",
            "queries": [
              {
                "name": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_end_date",
                "query": {
                  "datasetName": "c9815047",
                  "parameters": [
                    {
                      "name": "end_date",
                      "keyword": "end_date"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "end_date",
                    "queryName": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_end_date"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "End Date",
                "showDescription": false,
                "description": ""
              }
            }
          },
          "position": {
            "x": 3,
            "y": 3,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "461b14bf",
            "textbox_spec": "#  [dbdemos] Jobs and Workflows Monitoring\n**Note: Please run the _enable_system_table notebook to enable all the system tables first. Cluster system table support is being added in dbdemos for serverless, stay tuned.**\n- View key metrics across workspaces, including total jobs executed, DBUs consumed, dollar costs, and average job duration\n- Identify top users and jobs by DBU and dollar consumption\n- Monitor job outcomes with success/failure rates and trigger types for deeper insights\n- Track weekly and daily consumption trends by workspace to manage costs effectively"
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "a22773c8",
            "queries": [
              {
                "name": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_top_k",
                "query": {
                  "datasetName": "c9815047",
                  "parameters": [
                    {
                      "name": "top_k",
                      "keyword": "top_k"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "top_k",
                    "queryName": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_top_k"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "TopK",
                "showDescription": true,
                "description": "Limit Top Anlalysis to first K"
              }
            }
          },
          "position": {
            "x": 5,
            "y": 3,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "408d73e1",
            "queries": [
              {
                "name": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_tags",
                "query": {
                  "datasetName": "c9815047",
                  "parameters": [
                    {
                      "name": "tags",
                      "keyword": "tags"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "tags",
                    "queryName": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_tags"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Usage tags",
                "showDescription": true,
                "description": "Search by \"key=value\" pair, all lowercase."
              }
            }
          },
          "position": {
            "x": 4,
            "y": 3,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "c1696509",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "weekly(usage_date)",
                      "expression": "DATE_TRUNC(\"WEEK\", `usage_date`)"
                    },
                    {
                      "name": "countdistinct(run_id)",
                      "expression": "COUNT(DISTINCT `run_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "weekly(usage_date)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "usage_date"
                },
                "y": {
                  "fieldName": "countdistinct(run_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "Count of Unique run_id"
                },
                "color": {
                  "fieldName": "workspace_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "legend": {
                    "hide": false,
                    "position": "bottom"
                  },
                  "displayName": "workspace_id"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Weekly Trends: Number of Jobs by Workspace"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 13,
            "width": 3,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "29d90acc",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "countdistinct(run_id)",
                      "expression": "COUNT(DISTINCT `run_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(run_id)",
                  "displayName": "Count of Unique run_id"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Jobs Executed"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 5,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "c5010038",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "sum(usage_quantity)",
                      "expression": "SUM(`usage_quantity`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(usage_quantity)",
                  "format": {
                    "type": "number-plain",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  },
                  "displayName": "Sum of usage_quantity"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total DBUs Consumed"
              }
            }
          },
          "position": {
            "x": 1,
            "y": 5,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "5997fd20",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "sum(dollar_cost)",
                      "expression": "SUM(`dollar_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(dollar_cost)",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  },
                  "displayName": "Sum of dollar_cost"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Dollars Spent (List)"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 5,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "483f11e3",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "sum(dollar_cost)",
                      "expression": "SUM(`dollar_cost`)"
                    },
                    {
                      "name": "job_name_group",
                      "expression": "`job_name_group`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "sum(dollar_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  },
                  "displayName": "Sum of dollar_cost"
                },
                "y": {
                  "fieldName": "job_name_group",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "x-reversed"
                    }
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "job_name_group"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Top Jobs "
              }
            }
          },
          "position": {
            "x": 2,
            "y": 7,
            "width": 2,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "5421aefa",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "sum(dollar_cost)",
                      "expression": "SUM(`dollar_cost`)"
                    },
                    {
                      "name": "trigger_type",
                      "expression": "`trigger_type`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "sum(dollar_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  },
                  "displayName": "Sum of dollar_cost"
                },
                "color": {
                  "fieldName": "trigger_type",
                  "scale": {
                    "type": "categorical"
                  },
                  "legend": {
                    "hide": false
                  },
                  "displayName": "trigger_type"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Job Trigger Sources "
              }
            }
          },
          "position": {
            "x": 5,
            "y": 7,
            "width": 1,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "50d64d10",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "countdistinct(failure_run_ids)",
                      "expression": "COUNT(DISTINCT `failure_run_ids`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(failure_run_ids)",
                  "style": {
                    "color": "#E92828"
                  },
                  "displayName": "Count of Unique failure_run_ids"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total Unsuccessful Jobs"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 5,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "1cd2475a",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "countdistinct(success_run_ids)",
                      "expression": "COUNT(DISTINCT `success_run_ids`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(success_run_ids)",
                  "style": {
                    "color": "#3BD973"
                  },
                  "displayName": "Count of Unique success_run_ids"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Execution Success Rate"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 5,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "28755468",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "avg(duration_minutes)",
                      "expression": "AVG(`duration_minutes`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg(duration_minutes)",
                  "displayName": "Average duration_minutes"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Average Job Duration"
              }
            }
          },
          "position": {
            "x": 5,
            "y": 5,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "5d8d7bae",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "sum(dollar_cost)",
                      "expression": "SUM(`dollar_cost`)"
                    },
                    {
                      "name": "user_group",
                      "expression": "`user_group`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "sum(dollar_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  },
                  "displayName": "Sum of dollar_cost"
                },
                "y": {
                  "fieldName": "user_group",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "x-reversed"
                    }
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "user_group"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Top Users "
              }
            }
          },
          "position": {
            "x": 0,
            "y": 7,
            "width": 2,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "20281a73",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "weekly(usage_date)",
                      "expression": "DATE_TRUNC(\"WEEK\", `usage_date`)"
                    },
                    {
                      "name": "sum(dollar_cost)",
                      "expression": "SUM(`dollar_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "weekly(usage_date)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "usage_date"
                },
                "y": {
                  "fieldName": "sum(dollar_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  },
                  "displayName": "Sum of dollar_cost"
                },
                "color": {
                  "fieldName": "workspace_id",
                  "scale": {
                    "type": "categorical"
                  },
                  "legend": {
                    "hide": false,
                    "position": "bottom"
                  },
                  "displayName": "workspace_id"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Weekly Consumption by Workspace"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 13,
            "width": 3,
            "height": 7
          }
        },
        {
          "widget": {
            "name": "5418f266",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "sum(dollar_cost)",
                      "expression": "SUM(`dollar_cost`)"
                    },
                    {
                      "name": "result_state",
                      "expression": "`result_state`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pie",
              "encodings": {
                "angle": {
                  "fieldName": "sum(dollar_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "Sum of dollar_cost"
                },
                "color": {
                  "fieldName": "result_state",
                  "scale": {
                    "type": "categorical",
                    "mappings": [
                      {
                        "value": "1444828305810485",
                        "color": "#077A9D"
                      },
                      {
                        "value": "1660015457675682",
                        "color": "#FFAB00"
                      },
                      {
                        "value": "ERROR",
                        "color": "#FF3621"
                      },
                      {
                        "value": "0",
                        "color": "#077A9D"
                      },
                      {
                        "value": "CANCELLED",
                        "color": "#FFAB00"
                      },
                      {
                        "value": "SUCCEEDED",
                        "color": "#00A972"
                      }
                    ]
                  },
                  "displayName": "result_state"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Job Status"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 7,
            "width": 1,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "77b1b009",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "job_name_group",
                      "expression": "`job_name_group`"
                    },
                    {
                      "name": "daily(usage_date)",
                      "expression": "DATE_TRUNC(\"DAY\", `usage_date`)"
                    },
                    {
                      "name": "sum(dollar_cost)",
                      "expression": "SUM(`dollar_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(usage_date)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "usage_date"
                },
                "y": {
                  "fieldName": "sum(dollar_cost)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  },
                  "displayName": "Sum of dollar_cost"
                },
                "color": {
                  "fieldName": "job_name_group",
                  "scale": {
                    "type": "categorical"
                  },
                  "legend": {
                    "hide": false,
                    "position": "bottom"
                  },
                  "displayName": "job_name_group"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Daily Consumption by Workspace"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 20,
            "width": 6,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "29b84c6e",
            "queries": [
              {
                "name": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_workspace_id",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "workspace_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "workspace_id",
                    "displayName": "workspace_id",
                    "queryName": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_workspace_id"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace IDs"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 3,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "8a96b164",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "result_state",
                      "expression": "`result_state`"
                    },
                    {
                      "name": "daily(usage_date)",
                      "expression": "DATE_TRUNC(\"DAY\", `usage_date`)"
                    },
                    {
                      "name": "countdistinct(run_id)",
                      "expression": "COUNT(DISTINCT `run_id`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "daily(usage_date)",
                  "scale": {
                    "type": "temporal"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "usage_date"
                },
                "y": {
                  "fieldName": "countdistinct(run_id)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "Count of Unique run_id"
                },
                "color": {
                  "fieldName": "result_state",
                  "scale": {
                    "type": "categorical"
                  },
                  "legend": {
                    "hide": false,
                    "position": "bottom"
                  },
                  "displayName": "result_state"
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Daily Trends by Number of Executions"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 28,
            "width": 6,
            "height": 8
          }
        },
        {
          "widget": {
            "name": "f6970936",
            "queries": [
              {
                "name": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_start_date",
                "query": {
                  "datasetName": "c9815047",
                  "parameters": [
                    {
                      "name": "start_date",
                      "keyword": "start_date"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-date-picker",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "start_date",
                    "queryName": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_start_date"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Start Date",
                "showDescription": false,
                "description": ""
              }
            }
          },
          "position": {
            "x": 2,
            "y": 3,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "7d322444",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "user",
                      "expression": "`user`"
                    },
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "result_state",
                      "expression": "`result_state`"
                    },
                    {
                      "name": "sum(dollar_cost)",
                      "expression": "SUM(`dollar_cost`)"
                    }
                  ],
                  "cubeGroupingSets": {
                    "sets": [
                      {
                        "fieldNames": [
                          "job_name",
                          "user",
                          "workspace_id"
                        ]
                      },
                      {
                        "fieldNames": [
                          "result_state"
                        ]
                      }
                    ]
                  },
                  "disaggregated": false,
                  "orders": [
                    {
                      "direction": "ASC",
                      "expression": "`job_name`"
                    },
                    {
                      "direction": "ASC",
                      "expression": "`user`"
                    },
                    {
                      "direction": "ASC",
                      "expression": "`workspace_id`"
                    },
                    {
                      "direction": "ASC",
                      "expression": "`result_state`"
                    }
                  ]
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "pivot",
              "encodings": {
                "rows": [
                  {
                    "fieldName": "job_name",
                    "scale": {
                      "type": "categorical",
                      "sort": {
                        "by": "cell-reversed",
                        "field": {
                          "index": 0
                        }
                      }
                    },
                    "displayTotal": true,
                    "displayName": "job_name"
                  },
                  {
                    "fieldName": "user",
                    "displayTotal": false,
                    "displayName": "user"
                  },
                  {
                    "fieldName": "workspace_id",
                    "displayName": "workspace_id"
                  }
                ],
                "columns": [
                  {
                    "fieldName": "result_state",
                    "displayTotal": true,
                    "scale": {
                      "type": "categorical",
                      "sort": {
                        "by": "cell-reversed",
                        "field": {
                          "index": 0
                        }
                      }
                    },
                    "displayName": "result_state"
                  }
                ],
                "cell": {
                  "type": "multi-cell",
                  "fields": [
                    {
                      "fieldName": "sum(dollar_cost)",
                      "cellType": "text",
                      "style": {
                        "type": "basic",
                        "rules": [
                          {
                            "condition": {
                              "operator": ">="
                            },
                            "backgroundColor": "#00A972"
                          }
                        ]
                      },
                      "format": {
                        "type": "number-currency",
                        "currencyCode": "USD",
                        "abbreviation": "none",
                        "decimalPlaces": {
                          "type": "max",
                          "places": 1
                        },
                        "hideGroupSeparator": true
                      },
                      "displayName": "Sum of dollar_cost"
                    }
                  ]
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Top Jobs: Detail View"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 36,
            "width": 6,
            "height": 9
          }
        }
      ]
    },
    {
      "name": "31dc0e4d",
      "displayName": "Job Analysis",
      "layout": [
        {
          "widget": {
            "name": "b7f0b9f9",
            "textbox_spec": "#  [dbdemos] Jobs and Workflows Monitoring\n- Gain detailed insights into the execution history of specific jobs.\n- Filter by workspace, job name, and date range to refine the analysis.\n- Review job-level metrics, including total runs, average duration, and success/failure counts.\n- Analyze task-level details and trends for each job, helping identify patterns and troubleshoot issues."
          },
          "position": {
            "x": 0,
            "y": 0,
            "width": 6,
            "height": 3
          }
        },
        {
          "widget": {
            "name": "31b294b7",
            "queries": [
              {
                "name": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bee601b949b4b1298d5da1c58_workspace_id",
                "query": {
                  "datasetName": "a11eb5cf",
                  "fields": [
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "workspace_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bf73a10919065c86280ab7917_workspace_id",
                "query": {
                  "datasetName": "e61b017f",
                  "fields": [
                    {
                      "name": "workspace_id",
                      "expression": "`workspace_id`"
                    },
                    {
                      "name": "workspace_id_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_job_name",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "workspace_id",
                    "displayName": "workspace_id",
                    "queryName": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bee601b949b4b1298d5da1c58_workspace_id"
                  },
                  {
                    "fieldName": "workspace_id",
                    "displayName": "workspace_id",
                    "queryName": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bf73a10919065c86280ab7917_workspace_id"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_job_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Workspace IDs"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 3,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "c6e1987c",
            "queries": [
              {
                "name": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_start_date",
                "query": {
                  "datasetName": "c9815047",
                  "parameters": [
                    {
                      "name": "start_date",
                      "keyword": "start_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bf73a10919065c86280ab7917_start_date",
                "query": {
                  "datasetName": "e61b017f",
                  "parameters": [
                    {
                      "name": "start_date",
                      "keyword": "start_date"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "start_date",
                    "queryName": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_start_date"
                  },
                  {
                    "parameterName": "start_date",
                    "queryName": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bf73a10919065c86280ab7917_start_date"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Start Date"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 3,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "24c81113",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "e61b017f",
                  "fields": [
                    {
                      "name": "task_key",
                      "expression": "`task_key`"
                    },
                    {
                      "name": "daily(period_start_time)",
                      "expression": "DATE_TRUNC(\"DAY\", `period_start_time`)"
                    },
                    {
                      "name": "task_duration_minutes",
                      "expression": "`task_duration_minutes`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "line",
              "encodings": {
                "x": {
                  "fieldName": "daily(period_start_time)",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "period_start_time"
                },
                "y": {
                  "fieldName": "task_duration_minutes",
                  "scale": {
                    "type": "quantitative"
                  },
                  "displayName": "task_duration_minutes"
                },
                "color": {
                  "fieldName": "task_key",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "task_key"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Task Duration Trends"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 16,
            "width": 4,
            "height": 9
          }
        },
        {
          "widget": {
            "name": "25a6e292",
            "textbox_spec": "# Job Overview"
          },
          "position": {
            "x": 0,
            "y": 5,
            "width": 5,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "46211b90",
            "queries": [
              {
                "name": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bee601b949b4b1298d5da1c58_job_name",
                "query": {
                  "datasetName": "a11eb5cf",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bf73a10919065c86280ab7917_name",
                "query": {
                  "datasetName": "e61b017f",
                  "fields": [
                    {
                      "name": "name",
                      "expression": "`name`"
                    },
                    {
                      "name": "name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_job_name",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "job_name",
                      "expression": "`job_name`"
                    },
                    {
                      "name": "job_name_associativity",
                      "expression": "COUNT_IF(`associative_filter_predicate_group`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bee601b949b4b1298d5da1c58_job_name"
                  },
                  {
                    "fieldName": "name",
                    "displayName": "name",
                    "queryName": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bf73a10919065c86280ab7917_name"
                  },
                  {
                    "fieldName": "job_name",
                    "displayName": "job_name",
                    "queryName": "dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_job_name"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": "Job Name"
              },
              "disallowAll": true
            }
          },
          "position": {
            "x": 2,
            "y": 3,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "19c7599d",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a11eb5cf",
                  "fields": [
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "sum(usage_quantity)",
                      "expression": "SUM(`usage_quantity`)"
                    },
                    {
                      "name": "sum(avg_duration_minutes)",
                      "expression": "SUM(`avg_duration_minutes`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 1,
              "widgetType": "combo",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "usage_date"
                },
                "y": {
                  "primary": {
                    "fields": [
                      {
                        "fieldName": "sum(usage_quantity)",
                        "displayName": "dbu"
                      }
                    ],
                    "scale": {
                      "type": "quantitative"
                    },
                    "axis": {
                      "hideTitle": true
                    }
                  },
                  "secondary": {
                    "fields": [
                      {
                        "fieldName": "sum(avg_duration_minutes)",
                        "displayName": "average duration"
                      }
                    ],
                    "scale": {
                      "type": "quantitative"
                    },
                    "axis": {
                      "hideTitle": true
                    }
                  }
                },
                "label": {
                  "show": true
                }
              },
              "frame": {
                "title": "DBU Consumption Trend",
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 3,
            "y": 9,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "0da8a4f1",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "countdistinct(success_run_ids)",
                      "expression": "COUNT(DISTINCT `success_run_ids`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(success_run_ids)",
                  "style": {
                    "color": "#3BD973"
                  },
                  "displayName": "Count of Unique success_run_ids"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Successful Runs"
              }
            }
          },
          "position": {
            "x": 3,
            "y": 7,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "2e4957b1",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "countdistinct(failure_run_ids)",
                      "expression": "COUNT(DISTINCT `failure_run_ids`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "countdistinct(failure_run_ids)",
                  "style": {
                    "color": "#E92828"
                  },
                  "displayName": "Count of Unique failure_run_ids"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Unsuccessful Runs"
              }
            }
          },
          "position": {
            "x": 4,
            "y": 7,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "bd1a06fc",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "avg(duration_minutes)",
                      "expression": "AVG(`duration_minutes`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "avg(duration_minutes)",
                  "displayName": "Average duration_minutes"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Avg Duration"
              }
            }
          },
          "position": {
            "x": 5,
            "y": 7,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "a74e17a8",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a11eb5cf",
                  "fields": [
                    {
                      "name": "result_state",
                      "expression": "`result_state`"
                    },
                    {
                      "name": "usage_date",
                      "expression": "`usage_date`"
                    },
                    {
                      "name": "sum(runs)",
                      "expression": "SUM(`runs`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "usage_date",
                  "scale": {
                    "type": "temporal"
                  },
                  "displayName": "usage_date"
                },
                "y": {
                  "fieldName": "sum(runs)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "dbu"
                },
                "color": {
                  "fieldName": "result_state",
                  "scale": {
                    "type": "categorical"
                  },
                  "displayName": "result_state"
                }
              },
              "frame": {
                "title": "Number of Jobs by Result State",
                "showTitle": true
              }
            }
          },
          "position": {
            "x": 0,
            "y": 9,
            "width": 3,
            "height": 6
          }
        },
        {
          "widget": {
            "name": "d121d1d7",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "e61b017f",
                  "fields": [
                    {
                      "name": "avg(task_duration_minutes)",
                      "expression": "AVG(`task_duration_minutes`)"
                    },
                    {
                      "name": "task_key",
                      "expression": "`task_key`"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 3,
              "widgetType": "bar",
              "encodings": {
                "x": {
                  "fieldName": "avg(task_duration_minutes)",
                  "scale": {
                    "type": "quantitative"
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "Average task_duration_minutes"
                },
                "y": {
                  "fieldName": "task_key",
                  "scale": {
                    "type": "categorical",
                    "sort": {
                      "by": "x-reversed"
                    }
                  },
                  "axis": {
                    "hideTitle": true
                  },
                  "displayName": "task_key"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Average Task Execution Duration"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 16,
            "width": 2,
            "height": 9
          }
        },
        {
          "widget": {
            "name": "8f0376fa",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "sum(usage_quantity)",
                      "expression": "SUM(`usage_quantity`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(usage_quantity)",
                  "displayName": "Sum of usage_quantity"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total DBUs"
              }
            }
          },
          "position": {
            "x": 2,
            "y": 7,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "0a9390c7",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "a11eb5cf",
                  "fields": [
                    {
                      "name": "user",
                      "expression": "`user`"
                    }
                  ],
                  "disaggregated": true
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "user",
                  "displayName": "user"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Run As"
              }
            }
          },
          "position": {
            "x": 0,
            "y": 7,
            "width": 2,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "ea01ade6",
            "textbox_spec": "## Task Overview"
          },
          "position": {
            "x": 0,
            "y": 15,
            "width": 6,
            "height": 1
          }
        },
        {
          "widget": {
            "name": "1128326b",
            "queries": [
              {
                "name": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_end_date",
                "query": {
                  "datasetName": "c9815047",
                  "parameters": [
                    {
                      "name": "end_date",
                      "keyword": "end_date"
                    }
                  ],
                  "disaggregated": false
                }
              },
              {
                "name": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bf73a10919065c86280ab7917_end_date",
                "query": {
                  "datasetName": "e61b017f",
                  "parameters": [
                    {
                      "name": "end_date",
                      "keyword": "end_date"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "filter-single-select",
              "encodings": {
                "fields": [
                  {
                    "parameterName": "end_date",
                    "queryName": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa06a7c0016b89b3a4a182f54ac8d_end_date"
                  },
                  {
                    "parameterName": "end_date",
                    "queryName": "parameter_dashboards/01efa060c041104ea82e92f212f48db0/datasets/01efa09bf73a10919065c86280ab7917_end_date"
                  }
                ]
              },
              "frame": {
                "showTitle": true,
                "title": ""
              }
            }
          },
          "position": {
            "x": 5,
            "y": 3,
            "width": 1,
            "height": 2
          }
        },
        {
          "widget": {
            "name": "2fa90052",
            "queries": [
              {
                "name": "main_query",
                "query": {
                  "datasetName": "c9815047",
                  "fields": [
                    {
                      "name": "sum(dollar_cost)",
                      "expression": "SUM(`dollar_cost`)"
                    }
                  ],
                  "disaggregated": false
                }
              }
            ],
            "spec": {
              "version": 2,
              "widgetType": "counter",
              "encodings": {
                "value": {
                  "fieldName": "sum(dollar_cost)",
                  "format": {
                    "type": "number-currency",
                    "currencyCode": "USD",
                    "abbreviation": "compact",
                    "decimalPlaces": {
                      "type": "max",
                      "places": 1
                    }
                  },
                  "displayName": "Sum of dollar_cost"
                }
              },
              "frame": {
                "showTitle": true,
                "title": "Total $"
              }
            }
          },
          "position": {
            "x": 5,
            "y": 5,
            "width": 1,
            "height": 2
          }
        }
      ]
    }
  ]
}